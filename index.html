<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ЖДИТЕ НОВОГО ГОДА</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{background:#0a001f;color:#fff;overflow:hidden;height:100vh;font-family:Arial,sans-serif}
    .stars{position:fixed;top:0;left:0;width:100%;height:100%;background:url('https://assets.codepen.io/1538474/stars.png');animation:twinkle 8s infinite}
    @keyframes twinkle{0%,100%{opacity:.7}50%{opacity:1}}
    .northern-lights{position:fixed;top:0;left:0;width:100%;height:40%;background:linear-gradient(90deg,#00f260,#0575e6,#a166ab,#f093fb);opacity:.3;filter:blur(80px);animation:aurora 20s infinite alternate}
    @keyframes aurora{0%{transform:translateX(-20%)}100%{transform:translateX(20%)}}
    .snow{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none}
    .snow div{position:absolute;color:#fff;font-size:1.5em;animation:fall linear infinite}
    @keyframes fall{to{transform:translateY(100vh) rotate(360deg)}}
    .page{position:fixed;inset:0;transition:all 1.5s;opacity:0;z-index:-1}
    .page.active{opacity:1;z-index:10}
    .auth-card{background:rgba(10,0,40,.7);backdrop-filter:blur(15px);border:1px solid rgba(255,255,255,.1);border-radius:20px;max-width:420px}
    .btn-gold{background:linear-gradient(45deg,#ffd700,#ffb347);border:none;color:#000;font-weight:bold}
    .magic-title{font-size:5rem;background:linear-gradient(45deg,#ffd700,#fff,#87CEEB);-webkit-background-clip:text;background-clip:text;color:transparent;text-shadow:0 0 40px gold;animation:glow 3s infinite alternate}
    @keyframes glow{0%{text-shadow:0 0 40px gold}100%{text-shadow:0 0 80px #fff}}
    .christmas-tree{width:200px;height:300px;background:conic-gradient(from 0deg at 50% 10%,#0f0 0deg,#0c0 30deg,#090 60deg,transparent 90deg);border-radius:50% 50% 50% 50% / 60% 60% 40% 40%;position:relative;animation:tree 4s infinite}
    .christmas-tree::before{content:"★";position:absolute;top:-30px;left:50%;transform:translateX(-50%);font-size:60px;color:gold;animation:star 3s infinite}
    @keyframes tree{0%,100%{filter:brightness(1)}50%{filter:brightness(1.6)}}
    @keyframes star{0%,100%{transform:translateX(-50%) scale(1)}50%{transform:translateX(-50%) scale(1.3)}}
    @media(max-width:768px){.magic-title{font-size:3rem}}
  </style>
</head>
<body>

  <div id="auth" class="page active d-flex align-items-center justify-content-center">
    <div class="stars"></div>
    <div class="card auth-card shadow-lg p-5">
      <h1 class="text-center mb-4" style="color:#ffd700;font-size:3rem">Новый год близко</h1>
      <input type="email" id="email" class="form-control form-control-lg mb-3" placeholder="Email">
      <input type="password" id="password" class="form-control form-control-lg mb-3" placeholder="Пароль (6+ символов)">
      <button id="register" class="btn btn-gold btn-lg w-100 mb-2">Зарегистрироваться</button>
      <button id="login" class="btn btn-outline-light btn-lg w-100">Войти</button>
      <div id="msg" class="mt-3"></div>
    </div>
  </div>

  <div id="magic" class="page text-center d-flex flex-column justify-content-center align-items-center">
    <div class="snow"></div>
    <div class="northern-lights"></div>
    <h1 class="magic-title">ЖДИТЕ НОВОГО ГОДА</h1>
    <p style="font-size:2rem;color:#87CEEB">Мы готовим что-то невероятное...</p>
    <div class="christmas-tree"></div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.14.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.14.0/firebase-auth-compat.js"></script>
  <script>
    // СКРЫТЫЙ КОНФИГ — подгружаем с твоего Cloudflare Worker
    fetch('https://secret-firebase.denis-krivalts.workers.dev/')
      .then(r => r.json())
      .then(config => {
        firebase.initializeApp(config);
        const auth = firebase.auth();
        const msg = document.getElementById('msg');

        function show(txt, type='danger') {
          msg.innerHTML = `<div class="alert alert-${type} alert-dismissible fade show">
            ${txt}<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          </div>`;
        }

        document.getElementById('register').onclick = () => {
          const e = document.getElementById('email').value.trim();
          const p = document.getElementById('password').value;
          if (!e || !p) return show('Заполните все поля');
          auth.createUserWithEmailAndPassword(e, p)
            .then(() => { show('Успешно! Добро пожаловать!','success'); setTimeout(()=>location.reload(),2000); })
            .catch(err => show(err.message.includes('weak') ? 'Пароль слишком короткий' : err.message));
        };

        document.getElementById('login').onclick = () => {
          const e = document.getElementById('email').value.trim();
          const p = document.getElementById('password').value;
          if (!e || !p) return show('Заполните все поля');
          auth.signInWithEmailAndPassword(e, p)
            .catch(err => show('Неверный email или пароль'));
        };

        function openMagic() {
          document.getElementById('auth').classList.remove('active');
          document.getElementById('magic').classList.add('active');
          const s = document.querySelector('.snow');
          for(let i=0;i<160;i++){
            const f=document.createElement('div');
            f.textContent='❆❅✻*❄'[Math.floor(Math.random()*5)];
            f.style.left=Math.random()*100+'vw';
            f.style.animationDuration=6+Math.random()*14+'s';
            f.style.fontSize=(0.8+Math.random()*1.2)+'em';
            f.style.opacity=0.5+Math.random()*0.5;
            s.appendChild(f);
          }
        }

        auth.onAuthStateChanged(user => { if (user) openMagic(); });
      })
      .catch(() => alert('Ошибка соединения. Проверьте интернет или попробуйте позже.'));
  </script>
</body>
</html>
